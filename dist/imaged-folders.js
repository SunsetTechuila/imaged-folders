!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var e,m,u,d,g,t,i,n,a,r,o,l,c,s,f,y;e="sp://core-playlist/v1/rootlist",m="folder-image",u="main-yourLibraryX-libraryRootlist",d=".main-yourLibraryX-libraryRootlist > div",g=".main-yourLibraryX-librarySortWrapper > button",n=`li.main-useDropTarget-folder:has(${i=`div[${t="aria-labelledby"} *= "folder:"]`})`,a="main-image-image",r="main-cardImage-image",o="x-entityImage-image",l="#spicetify-playlist-list > div > div:nth-child(2)",c="#spicetify-playlist-list .main-gridContainer-gridContainer",s="playlist.edit-details.remove-photo",f="playlist.edit-details.error.file-upload-failed",y="choose_photo",(async()=>{await R()})();function p(){return Boolean(document.querySelector(c))}function v(e){e.getElementsByClassName(a)[0]?.remove(),e.querySelector('div[class *= "imagePlaceholder"]')?.remove()}function h(){return document.querySelector(p()?c:l)}function w(e){return document.querySelector(n.replace('folder:"',`folder:${e}"`))}function S(e){return e.querySelector(p()?".main-cardImage-imageWrapper > div":".x-entityImage-imageContainer")}function b(e){if(!(e instanceof Element))return Spicetify.URI.from(e)?.id;e=e.querySelector(i);if(e){e=e.getAttribute(t)?.match(/folder:(\w+)$/);if(e)return e[1]}}function C(){var i=[],a=document.querySelectorAll(n);for(let e=0,t=a.length;e<t;e+=1){var r=function(e){var t=b(e);if(t){t=localStorage.getItem(m+":"+t);if(t){e=S(e);if(e)return{imageContainer:e,imageBase64:t}}}return null}(a[e]);r&&i.push(r)}return i}function I(e,t){var i=document.createElement("img");i.classList.add(a,"main-image-loaded",p()?r:o),i.src=t,v(e),e.prepend(i)}function E(e){t=document.createElement("div"),i=document.createElementNS("http://www.w3.org/2000/svg","svg"),a=document.createElementNS("http://www.w3.org/2000/svg","path"),n=p(),r=n?"64":"24",t.classList.add(n?"main-card-imagePlaceholder":"x-entityImage-imagePlaceholder"),i.classList.add("Svg-sc-ytk21e-0",n?"Svg-img-textSubdued-64-icon":"Svg-img-24-icon"),i.setAttribute("height",r+"px"),i.setAttribute("width",r+"px"),i.setAttribute("viewBox","0 0 24 24"),i.setAttribute("aria-hidden","true"),i.setAttribute("role","img"),a.setAttribute("d","M1 4a2 2 0 0 1 2-2h5.155a3 3 0 0 1 2.598 1.5l.866 1.5H21a2 2 0 0 1 2 2v13a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4zm7.155 0H3v16h18V7H10.464L9.021 4.5a1 1 0 0 0-.866-.5z"),i.appendChild(a),t.appendChild(i);var t,i,a,r,n=t;v(e),e.prepend(n)}async function L(){const i=[];return(await Spicetify.CosmosAsync.get(e)).rows?.forEach(e=>function t(e){"folder"===e.type&&(i.push(e.id),e.rows?.forEach(e=>t(e)))}(e)),i}function x(){var i,a=C();for(let e=0,t=a.length;e<t;e+=1)i=a[e].imageContainer,Boolean(i.getElementsByClassName(p()?r:o)[0])||I(a[e].imageContainer,a[e].imageBase64)}function A(){var{ContextMenu:e,Locale:t}=Spicetify;const i=Spicetify.URI["isFolder"];var a=t.get(s);const n=t.get(f);var r,o,t=t.get(y);(r=document.createElement("form")).setAttribute("aria-hidden","true"),(o=document.createElement("input")).classList.add("hidden-visually"),o.setAttribute("type","file"),o.accept=["image/jpeg","image/avif","image/png","image/webp"].join(","),r.appendChild(o);const[l,c]=[r,o];c.onchange=()=>{var e;c.files?.length&&((e=new FileReader).onload=async t=>{try{var i=c["id"];let e=t.target?.result;150<2*(m+":"+i+e).length/1e3&&(e=(o=e,await new Promise(r=>{const n=new Image;n.onload=()=>{let{width:e,height:t}=n;e>t?(t*=354/e,e=354):t=(t>e?e*=354/t:e=354,354);var i=document.createElement("canvas");i.width=e,i.height=t;i.getContext("2d").drawImage(n,0,0,e,t);var a=i.toDataURL("image/jpeg");i.remove(),r(a)},n.src=o}))),a=i,r=e,localStorage.setItem(m+":"+a,r),(a=w(a))&&(a=S(a))&&I(a,r)}catch(e){Spicetify.showNotification(n+`
`+String(e),!0)}var a,r,o},e.readAsDataURL(c.files[0]))},new e.Item(a,([e])=>{var e=b(e);e&&(e=e,localStorage.removeItem(m+":"+e),e=w(e))&&(e=S(e))&&E(e)},([e])=>{return i(e)&&(e=b(e),Boolean(localStorage.getItem(m+":"+e)))},"x").register(),new e.Item(t,([e])=>{e=b(e);e&&(c.id=e,l.reset(),c.click())},([e])=>i(e),"edit").register()}function R(){if(Spicetify?.Locale&&Spicetify?.URI&&Spicetify?.ContextMenu&&Spicetify?.CosmosAsync&&h()){x();{let t=h();const o=new MutationObserver(x),l={childList:!0};function i(e){(t=h())?(e(),o.observe(t,l)):setTimeout(i,300)}o.observe(t,l);var a=document.querySelector(d);new MutationObserver(function(){t?.isConnected||i(x)}).observe(a,{childList:!0});let e;const c={attributes:!0,attributeFilter:["aria-label"]},s=new MutationObserver(n);function r(){setTimeout(()=>{(e=document.querySelector(g))instanceof HTMLButtonElement&&s.observe(e,c)},300)}function n(){i(()=>{x(),e?.isConnected||r()})}r(),a=document.getElementsByClassName(u)[0],new MutationObserver(n).observe(a,{attributes:!0,attributeFilter:["class"]})}A(),!async function(){var i=await L();for(let e=0,t=localStorage.length;e<t;e+=1){var a=localStorage.key(e),r=new RegExp(m+":(\\w+)$"),r=a.match(r);r&&(r=r[1],-1===i.indexOf(r))&&localStorage.removeItem(a)}}()}else setTimeout(R,300)}}();