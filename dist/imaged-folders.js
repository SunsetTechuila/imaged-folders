!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));var e,u,m,d,g,t,i,r,a,o,n,c,l,s,f,y,p,v,h;e="sp://core-playlist/v1/rootlist",u="folder-image",m=".main-yourLibraryX-libraryRootlist",d=".main-yourLibraryX-libraryRootlist > div",g=".main-yourLibraryX-librarySortWrapper > button",r=`li.main-useDropTarget-folder:has(${i=`div[${t="aria-labelledby"} *= "folder:"]`})`,c="."+(a="main-image-image"),l="."+(o="main-cardImage-image"),s="."+(n="x-entityImage-image"),f="#spicetify-playlist-list > div > div:nth-child(2)",y="#spicetify-playlist-list .main-gridContainer-gridContainer",p="playlist.edit-details.remove-photo",v="playlist.edit-details.error.file-upload-failed",h="choose_photo",(async()=>{await B()})();function S(){return Boolean(document.querySelector(y))}function w(e){e.querySelector(c)?.remove(),e.querySelector('div[class *= "imagePlaceholder"]')?.remove()}function b(){return document.querySelector(S()?y:f)}function I(e){return document.querySelector(r.replace('folder:"',`folder:${e}"`))}function C(e){return e.querySelector(S()?".main-cardImage-imageWrapper > div":".x-entityImage-imageContainer")}function L(e){if(!(e instanceof Element))return Spicetify.URI.from(e)?.id;e=e.querySelector(i);if(e){e=e.getAttribute(t)?.match(/folder:(\w+)$/);if(e)return e[1]}}function A(){const t=[];return Array.from(document.querySelectorAll(r)).forEach(e=>{e=function(e){var t=L(e);if(t){t=localStorage.getItem(u+":"+t);if(t){e=C(e);if(e)return{imageContainer:e,imageBase64:t}}}return null}(e);e&&t.push(e)}),t}function E(e,t){var i=document.createElement("img");i.classList.add(a,"main-image-loaded",S()?o:n),i.src=t,w(e),e.prepend(i)}function x(e){t=document.createElement("div"),i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=document.createElementNS("http://www.w3.org/2000/svg","path"),o=S(),a=o?"64":"24",t.classList.add(o?"main-card-imagePlaceholder":"x-entityImage-imagePlaceholder"),i.classList.add("Svg-sc-ytk21e-0",o?"Svg-img-textSubdued-64-icon":"Svg-img-24-icon"),i.setAttribute("height",a+"px"),i.setAttribute("width",a+"px"),i.setAttribute("viewBox","0 0 24 24"),i.setAttribute("aria-hidden","true"),i.setAttribute("role","img"),r.setAttribute("d","M1 4a2 2 0 0 1 2-2h5.155a3 3 0 0 1 2.598 1.5l.866 1.5H21a2 2 0 0 1 2 2v13a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V4zm7.155 0H3v16h18V7H10.464L9.021 4.5a1 1 0 0 0-.866-.5z"),i.appendChild(r),t.appendChild(i);var t,i,r,a,o=t;w(e),e.prepend(o)}async function q(){const i=[];return(await Spicetify.CosmosAsync.get(e)).rows?.forEach(e=>function t(e){"folder"===e.type&&(i.push(e.id),e.rows?.forEach(e=>t(e)))}(e)),i}function R(){A().forEach(e=>{var t;t=e.imageContainer,Boolean(t.querySelector(S()?l:s))||E(e.imageContainer,e.imageBase64)})}function M(){var{ContextMenu:e,Locale:t}=Spicetify;const i=Spicetify.URI["isFolder"];var r=t.get(p);const o=t.get(v);var a,n,t=t.get(h);(a=document.createElement("form")).setAttribute("aria-hidden","true"),(n=document.createElement("input")).classList.add("hidden-visually"),n.setAttribute("type","file"),n.accept=["image/jpeg","image/avif","image/png","image/webp"].join(","),a.appendChild(n);const[c,l]=[a,n];l.onchange=()=>{var e;l.files?.length&&((e=new FileReader).onload=async t=>{try{var i=l["id"];let e=t.target?.result;150<2*(u+":"+i+e).length/1e3&&(e=(n=e,await new Promise(a=>{const o=new Image;o.onload=()=>{let{width:e,height:t}=o;e>t?(t*=354/e,e=354):t=(t>e?e*=354/t:e=354,354);var i=document.createElement("canvas");i.width=e,i.height=t;i.getContext("2d").drawImage(o,0,0,e,t);var r=i.toDataURL("image/jpeg");i.remove(),a(r)},o.src=n}))),r=i,a=e,localStorage.setItem(u+":"+r,a),(r=I(r))&&(r=C(r))&&E(r,a)}catch(e){Spicetify.showNotification(o+`
`+String(e),!0)}var r,a,n},e.readAsDataURL(l.files[0]))},new e.Item(r,([e])=>{var e=L(e);e&&(e=e,localStorage.removeItem(u+":"+e),e=I(e))&&(e=C(e))&&x(e)},([e])=>{return i(e)&&(e=L(e),Boolean(localStorage.getItem(u+":"+e)))},"x").register(),new e.Item(t,([e])=>{e=L(e);e&&(l.id=e,c.reset(),l.click())},([e])=>i(e),"edit").register()}function B(){if(Spicetify?.Locale&&Spicetify?.URI&&Spicetify?.ContextMenu&&Spicetify?.CosmosAsync&&b()){R();{let t=b();const n=new MutationObserver(R),c={childList:!0};function i(e){(t=b())?(e(),n.observe(t,c)):setTimeout(i,300)}n.observe(t,c);var r=document.querySelector(d);new MutationObserver(function(){t?.isConnected||i(R)}).observe(r,{childList:!0});let e;const l={attributes:!0,attributeFilter:["aria-label"]},s=new MutationObserver(o);function a(){setTimeout(()=>{(e=document.querySelector(g))instanceof HTMLButtonElement&&s.observe(e,l)},300)}function o(){i(()=>{R(),e?.isConnected||a()})}a(),r=document.querySelector(m),new MutationObserver(o).observe(r,{attributes:!0,attributeFilter:["class"]})}M(),!async function(){var i=await q();for(let e=0,t=localStorage.length;e<t;e+=1){var r=localStorage.key(e),a=new RegExp(u+":(\\w+)$"),a=r.match(a);a&&(a=a[1],-1===i.indexOf(a))&&localStorage.removeItem(r)}}()}else setTimeout(B,300)}}();